{
  "Weni Agent Definition YAML": {
    "prefix": "weni-agent",
    "body": [
      "agent:",
      "  name: \"${1:AgentName}\"",
      "  version: \"${2:1.0.0}\"",
      "  description: \"${3:Brief description}\"",
      "",
      "credentials:",
      "  - name: ${4:API_KEY}",
      "    description: \"${5:API key description}\"",
      "",
      "constants:",
      "  - name: ${6:BASE_URL}",
      "    value: \"${7:https://api.example.com}\"",
      "",
      "instructions: |",
      "  You are an AI assistant that ${8:helps users with...}",
      "  ",
      "  Key responsibilities:",
      "  - ${9:Task 1}",
      "  - ${10:Task 2}",
      "  ",
      "  Always:",
      "  - Be polite and professional",
      "  - Validate user inputs",
      "  - Provide clear error messages",
      "",
      "guardrails:",
      "  - type: check_message_limit",
      "    params:",
      "      max_messages: ${11:20}",
      "",
      "tools:",
      "  - name: ${12:ToolName}",
      "    path: tools/${12:toolName}",
      "$0"
    ],
    "description": "Complete Weni agent_definition.yaml template"
  },

  "Weni Python Tool Class": {
    "prefix": "weni-tool",
    "body": [
      "from weni import Tool, Context, TextResponse",
      "import requests",
      "",
      "",
      "class ${1:ToolName}(Tool):",
      "    def execute(self, context: Context, **kwargs) -> TextResponse:",
      "        \"\"\"",
      "        ${2:Brief description of what this tool does.}",
      "        ",
      "        Args:",
      "            ${3:param1} (${4:str}): ${5:Description}",
      "            ${6:param2} (${7:int}): ${8:Description}",
      "            ",
      "        Returns:",
      "            TextResponse: Success or error message",
      "        \"\"\"",
      "        # Get credentials",
      "        api_key = context.credentials.get(\"${9:API_KEY}\")",
      "        base_url = context.constants.get(\"${10:BASE_URL}\")",
      "        ",
      "        # Get parameters",
      "        ${3:param1} = kwargs.get(\"${3:param1}\")",
      "        ",
      "        # Validation",
      "        if not ${3:param1}:",
      "            return TextResponse(",
      "                text=\"‚ùå ERROR: ${3:param1} is required\",",
      "                should_wait_agent_response=True",
      "            )",
      "        ",
      "        # Logging",
      "        print(f\"[INFO] Processing {${3:param1}}\")",
      "        ",
      "        try:",
      "            # API call",
      "            response = requests.get(",
      "                f\"{base_url}/${11:endpoint}\",",
      "                headers={\"Authorization\": f\"Bearer {api_key}\"},",
      "                params={\"${12:param}\": ${3:param1}},",
      "                timeout=10",
      "            )",
      "            ",
      "            if response.status_code == 200:",
      "                data = response.json()",
      "                return TextResponse(",
      "                    text=f\"‚úÖ Success: {data}\",",
      "                    should_wait_agent_response=True",
      "                )",
      "            else:",
      "                print(f\"[WARN] API returned {response.status_code}\")",
      "                return TextResponse(",
      "                    text=f\"‚ö†Ô∏è API Error: {response.status_code}\",",
      "                    should_wait_agent_response=True",
      "                )",
      "                ",
      "        except requests.exceptions.Timeout:",
      "            print(\"[ERROR] Request timeout\")",
      "            return TextResponse(",
      "                text=\"‚ö†Ô∏è Request timeout. Please try again.\",",
      "                should_wait_agent_response=True",
      "            )",
      "        except Exception as e:",
      "            print(f\"[ERROR] {str(e)}\")",
      "            return TextResponse(",
      "                text=f\"‚ùå Error: {str(e)}\",",
      "                should_wait_agent_response=True",
      "            )",
      "$0"
    ],
    "description": "Complete Weni Tool class template with error handling"
  },

  "VTEX Region API Call": {
    "prefix": "vtex-region",
    "body": [
      "# Check CEP coverage",
      "region_url = f\"https://{account_name}.vtexcommercestable.com.br/api/checkout/pub/regions\"",
      "region_response = requests.get(",
      "    region_url,",
      "    params={",
      "        \"country\": \"${1:BRA}\",",
      "        \"postalCode\": ${2:cep}",
      "    },",
      "    timeout=10",
      ")",
      "",
      "if region_response.status_code == 200:",
      "    region_data = region_response.json()",
      "    region_id = region_data.get(\"id\")",
      "    print(f\"[INFO] Region ID: {region_id}\")",
      "else:",
      "    return TextResponse(",
      "        text=\"‚ùå CEP n√£o encontrado ou fora da √°rea de cobertura\",",
      "        should_wait_agent_response=True",
      "    )",
      "$0"
    ],
    "description": "VTEX Region API call for CEP validation"
  },

  "VTEX Intelligent Search": {
    "prefix": "vtex-search",
    "body": [
      "# Product search with regionalization",
      "search_url = f\"https://{account_name}.vtexcommercestable.com.br/api/io/_v/api/intelligent-search/product_search\"",
      "search_response = requests.get(",
      "    search_url,",
      "    params={",
      "        \"query\": ${1:search_term},",
      "        \"regionId\": ${2:region_id},",
      "        \"_from\": 0,",
      "        \"_to\": ${3:2}  # Get top 3 results",
      "    },",
      "    timeout=10",
      ")",
      "",
      "if search_response.status_code == 200:",
      "    products = search_response.json().get(\"products\", [])",
      "    ",
      "    if not products:",
      "        return TextResponse(",
      "            text=\"‚ùå Nenhum produto encontrado para esta busca\",",
      "            should_wait_agent_response=True",
      "        )",
      "    ",
      "    # Format results",
      "    result_text = f\"üîç Encontrei {len(products)} produtos:\\n\\n\"",
      "    for i, product in enumerate(products, 1):",
      "        name = product.get(\"productName\")",
      "        price = product.get(\"price\", 0) / 100  # Convert cents",
      "        link = product.get(\"link\")",
      "        result_text += f\"{i}. {name}\\nR$ {price:.2f}\\n{link}\\n\\n\"",
      "    ",
      "    return TextResponse(",
      "        text=result_text,",
      "        should_wait_agent_response=True",
      "    )",
      "$0"
    ],
    "description": "VTEX Intelligent Search API call"
  },

  "VTEX Cart Simulation": {
    "prefix": "vtex-simulation",
    "body": [
      "# Simulate cart with shipping",
      "simulation_url = f\"https://{account_name}.vtexcommercestable.com.br/api/checkout/pub/orderForms/simulation\"",
      "payload = {",
      "    \"items\": [",
      "        {",
      "            \"id\": ${1:sku_id},",
      "            \"quantity\": ${2:quantity},",
      "            \"seller\": \"${3:1}\"",
      "        }",
      "    ],",
      "    \"postalCode\": ${4:cep},",
      "    \"country\": \"${5:BRA}\"",
      "}",
      "",
      "simulation_response = requests.post(",
      "    simulation_url,",
      "    json=payload,",
      "    headers={\"Content-Type\": \"application/json\"},",
      "    timeout=10",
      ")",
      "",
      "if simulation_response.status_code == 200:",
      "    data = simulation_response.json()",
      "    ",
      "    # Check stock",
      "    items = data.get(\"items\", [])",
      "    if not items or items[0].get(\"availability\") != \"available\":",
      "        return TextResponse(",
      "            text=\"‚ùå Produto indispon√≠vel no momento\",",
      "            should_wait_agent_response=True",
      "        )",
      "    ",
      "    # Get prices",
      "    total_items = data.get(\"totals\", [])",
      "    items_value = sum(t[\"value\"] for t in total_items if t[\"id\"] == \"Items\") / 100",
      "    shipping_value = sum(t[\"value\"] for t in total_items if t[\"id\"] == \"Shipping\") / 100",
      "    total_value = sum(t[\"value\"] for t in total_items) / 100",
      "    ",
      "    # Get logistics",
      "    slas = data.get(\"logisticsInfo\", [])[0].get(\"slas\", [])",
      "    delivery_time = slas[0].get(\"shippingEstimate\") if slas else \"N/A\"",
      "    ",
      "    result_text = (",
      "        f\"üì¶ Simula√ß√£o de Frete:\\n\\n\"",
      "        f\"Produtos: R$ {items_value:.2f}\\n\"",
      "        f\"Frete: R$ {shipping_value:.2f}\\n\"",
      "        f\"Total: R$ {total_value:.2f}\\n\"",
      "        f\"Prazo: {delivery_time}\"",
      "    )",
      "    ",
      "    return TextResponse(",
      "        text=result_text,",
      "        should_wait_agent_response=True",
      "    )",
      "$0"
    ],
    "description": "VTEX Cart Simulation API call"
  },

  "Weni Flows Trigger": {
    "prefix": "weni-flow",
    "body": [
      "# Trigger Weni Flow",
      "flow_url = \"https://flows.weni.ai/api/v2/flow_starts.json\"",
      "flow_token = context.credentials.get(\"${1:WENI_FLOWS_TOKEN}\")",
      "",
      "payload = {",
      "    \"flow\": \"${2:flow-uuid-here}\",",
      "    \"urns\": [${3:contact_urn}],  # e.g., \"whatsapp:5511999999999\"",
      "    \"extra\": {",
      "        \"${4:key1}\": ${5:value1},",
      "        \"${6:key2}\": ${7:value2}",
      "    },",
      "    \"restart_participants\": True",
      "}",
      "",
      "flow_response = requests.post(",
      "    flow_url,",
      "    json=payload,",
      "    headers={\"Authorization\": f\"Token {flow_token}\"},",
      "    timeout=10",
      ")",
      "",
      "if flow_response.status_code == 201:",
      "    print(\"[INFO] Flow triggered successfully\")",
      "    return TextResponse(",
      "        text=\"‚úÖ Mensagem enviada com sucesso\",",
      "        should_wait_agent_response=True",
      "    )",
      "else:",
      "    print(f\"[ERROR] Flow trigger failed: {flow_response.status_code}\")",
      "    return TextResponse(",
      "        text=\"‚ö†Ô∏è N√£o foi poss√≠vel enviar a mensagem\",",
      "        should_wait_agent_response=True",
      "    )",
      "$0"
    ],
    "description": "Weni Flows trigger API call"
  },

  "Error Handling Try-Except": {
    "prefix": "weni-try",
    "body": [
      "try:",
      "    ${1:# API call or operation}",
      "    ",
      "except requests.exceptions.Timeout:",
      "    print(\"[ERROR] Request timeout\")",
      "    return TextResponse(",
      "        text=\"‚ö†Ô∏è Tempo limite excedido. Tente novamente.\",",
      "        should_wait_agent_response=True",
      "    )",
      "except requests.exceptions.ConnectionError:",
      "    print(\"[ERROR] Connection failed\")",
      "    return TextResponse(",
      "        text=\"‚ö†Ô∏è Erro de conex√£o. Verifique sua internet.\",",
      "        should_wait_agent_response=True",
      "    )",
      "except requests.exceptions.HTTPError as e:",
      "    print(f\"[ERROR] HTTP error: {e}\")",
      "    return TextResponse(",
      "        text=f\"‚ö†Ô∏è Erro na API: {e}\",",
      "        should_wait_agent_response=True",
      "    )",
      "except Exception as e:",
      "    print(f\"[ERROR] Unexpected error: {str(e)}\")",
      "    return TextResponse(",
      "        text=f\"‚ùå Erro inesperado: {str(e)}\",",
      "        should_wait_agent_response=True",
      "    )",
      "$0"
    ],
    "description": "Complete error handling for API calls"
  },

  "Input Validation": {
    "prefix": "weni-validate",
    "body": [
      "# Validate required parameters",
      "${1:param_name} = kwargs.get(\"${1:param_name}\")",
      "",
      "if not ${1:param_name}:",
      "    return TextResponse(",
      "        text=\"‚ùå ERROR: ${1:param_name} √© obrigat√≥rio\",",
      "        should_wait_agent_response=True",
      "    )",
      "",
      "# Additional validation (optional)",
      "if ${2:condition}:",
      "    return TextResponse(",
      "        text=\"‚ùå ERROR: ${3:validation message}\",",
      "        should_wait_agent_response=True",
      "    )",
      "$0"
    ],
    "description": "Parameter validation pattern"
  },

  "CEP Formatting": {
    "prefix": "format-cep",
    "body": [
      "# Format CEP (remove non-digits)",
      "import re",
      "${1:cep} = re.sub(r'\\D', '', str(${1:cep}))",
      "",
      "# Validate CEP length",
      "if len(${1:cep}) != 8:",
      "    return TextResponse(",
      "        text=\"‚ùå CEP inv√°lido. Digite 8 d√≠gitos.\",",
      "        should_wait_agent_response=True",
      "    )",
      "$0"
    ],
    "description": "CEP formatting and validation"
  },

  "Logging Pattern": {
    "prefix": "weni-log",
    "body": [
      "print(f\"[${1|INFO,WARN,ERROR,DEBUG|}] ${2:message}\")",
      "$0"
    ],
    "description": "Structured logging with level"
  }
}
